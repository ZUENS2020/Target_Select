# è¿‡æ—¶ä¾èµ–æ£€æµ‹ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

`target_select_outdated.py` æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ£€æµ‹è¿‡æ—¶ä¾èµ–çš„å·¥å…·ã€‚ä¸å…¶ä»–ç‰ˆæœ¬ä¸åŒï¼Œå®ƒ**ä¸ä½¿ç”¨æœç´¢API**ï¼Œè€Œæ˜¯ç›´æ¥è·å–æœ€è¿‘2ä¸ªæœˆå†…star > 500çš„é¡¹ç›®ï¼Œç„¶åæ£€æµ‹è¿™äº›é¡¹ç›®çš„ä¾èµ–çŠ¶æ€ã€‚

## ä¸»è¦ç‰¹æ€§

- âœ… **ç›´æ¥è·å–**ï¼šä¸ä½¿ç”¨GitHubæœç´¢APIï¼Œç›´æ¥åˆ—å‡ºå…¬å¼€ä»“åº“
- âœ… **æ—¶é—´ç­›é€‰**ï¼šåªè·å–æœ€è¿‘2ä¸ªæœˆï¼ˆ60å¤©ï¼‰å†…æ›´æ–°çš„é¡¹ç›®
- âœ… **æµè¡Œåº¦ç­›é€‰**ï¼šåªä¿ç•™staræ•° > 500çš„é¡¹ç›®
- âœ… **ä¾èµ–æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹Dependabotè­¦æŠ¥å’Œä¾èµ–æ–‡ä»¶
- âœ… **CodeQLå‡†å¤‡**ï¼šä¸ºæ”¯æŒçš„é¡¹ç›®ç”ŸæˆCodeQLåˆ†æé…ç½®

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```bash
python target_select_outdated.py
```

### ä½¿ç”¨GitHub Tokenï¼ˆå¼ºçƒˆæ¨èï¼‰

```bash
export GITHUB_TOKEN=your_personal_access_token
python target_select_outdated.py
```

## å·¥ä½œåŸç†

### 1. è·å–é¡¹ç›®é˜¶æ®µ

å·¥å…·ä½¿ç”¨GitHubçš„ `/repositories` APIç«¯ç‚¹ç›´æ¥åˆ—å‡ºæ‰€æœ‰å…¬å¼€ä»“åº“ï¼Œç„¶åï¼š

- è·å–æ¯ä¸ªä»“åº“çš„è¯¦ç»†ä¿¡æ¯
- è¿‡æ»¤å‡ºstar > 500çš„ä»“åº“
- è¿‡æ»¤å‡ºæœ€è¿‘60å¤©å†…æ›´æ–°çš„ä»“åº“

**æ³¨æ„**ï¼šè¿™ç§æ–¹æ³•æ¯”æœç´¢APIæ›´å¯é ï¼Œä½†éœ€è¦æ›´å¤šAPIè°ƒç”¨ã€‚

### 2. ä¾èµ–æ£€æµ‹é˜¶æ®µ

å¯¹æ¯ä¸ªç¬¦åˆæ¡ä»¶çš„é¡¹ç›®ï¼Œå·¥å…·ä¼šï¼š

#### a. æ£€æŸ¥Dependabotè­¦æŠ¥

é€šè¿‡APIæ£€æŸ¥é¡¹ç›®æ˜¯å¦å¯ç”¨äº†Dependabotå®‰å…¨è­¦æŠ¥ï¼š

```
GET /repos/{owner}/{repo}/vulnerability-alerts
```

å¦‚æœè¿”å›204ï¼Œè¯´æ˜å¯ç”¨äº†å®‰å…¨è­¦æŠ¥ï¼ˆå¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼‰ã€‚

#### b. æ£€æµ‹ä¾èµ–æ–‡ä»¶

æ£€æŸ¥é¡¹ç›®æ˜¯å¦åŒ…å«å¸¸è§çš„ä¾èµ–ç®¡ç†æ–‡ä»¶ï¼š

| æ–‡ä»¶å | ç”Ÿæ€ç³»ç»Ÿ |
|--------|---------|
| package.json | JavaScript/Node.js |
| requirements.txt | Python |
| Pipfile | Python |
| pom.xml | Java/Maven |
| build.gradle | Java/Gradle |
| Gemfile | Ruby |
| go.mod | Go |
| composer.json | PHP |
| Cargo.toml | Rust |

å¦‚æœæ‰¾åˆ°è¿™äº›æ–‡ä»¶ï¼Œå·¥å…·ä¼šæ ‡è®°é¡¹ç›®å¯èƒ½æœ‰è¿‡æ—¶ä¾èµ–ã€‚

### 3. CodeQLå‡†å¤‡é˜¶æ®µ

å¯¹äºCodeQLæ”¯æŒçš„è¯­è¨€ï¼ˆPython, JavaScript, Java, C/C++, C#, Go, Rubyï¼‰ï¼Œå·¥å…·ä¼šï¼š

- æ£€æŸ¥é¡¹ç›®è¯­è¨€æ˜¯å¦è¢«CodeQLæ”¯æŒ
- ç”ŸæˆGitHub Actionså·¥ä½œæµé…ç½®æ–‡ä»¶
- ä¿å­˜é…ç½®åˆ° `/tmp/codeql_analysis/` ç›®å½•

ç”Ÿæˆçš„å·¥ä½œæµæ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨äºGitHub Actionsè¿›è¡Œè‡ªåŠ¨åŒ–å®‰å…¨åˆ†æã€‚

## è¾“å‡ºè¯´æ˜

### ç»ˆç«¯è¾“å‡º

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     Target Select Outdated - è¿‡æ—¶ä¾èµ–é¡¹ç›®æ£€æµ‹å·¥å…·              â•‘
â•‘                                                               â•‘
â•‘  ç›´æ¥è·å–æœ€è¿‘2ä¸ªæœˆå†… star > 500 çš„é¡¹ç›®                         â•‘
â•‘  æ£€æµ‹è¿‡æ—¶ä¾èµ–å¹¶å‡†å¤‡ CodeQL åˆ†æ                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” æ­£åœ¨è·å–æœ€è¿‘ 60 å¤©å†… star > 500 çš„é¡¹ç›®...
   æ—¶é—´èŒƒå›´: 2024-08-24 è‡³ä»Š

  âœ“ æ‰¾åˆ°: owner/repo1 (1234 stars, æ›´æ–°äº 2024-10-20T10:30:00Z)
  âœ“ æ‰¾åˆ°: owner/repo2 (5678 stars, æ›´æ–°äº 2024-10-21T14:20:00Z)
  ...

æ‰¾åˆ° 25 ä¸ªç¬¦åˆæ¡ä»¶çš„ä»“åº“

ğŸ” æ­£åœ¨æ£€æŸ¥è¿‡æ—¶ä¾èµ–...

[1/25] æ£€æŸ¥ owner/repo1... âœ“ å¯èƒ½æœ‰è¿‡æ—¶ä¾èµ–
[2/25] æ£€æŸ¥ owner/repo2... - æœªæ£€æµ‹åˆ°æ˜æ˜¾çš„ä¾èµ–é—®é¢˜
...

================================================================================
æ‰¾åˆ° 15 ä¸ªå¯èƒ½æœ‰è¿‡æ—¶ä¾èµ–çš„é¡¹ç›®
================================================================================

[1] owner/repo1
    â­ Stars: 1234 | ğŸ´ Forks: 567
    ğŸ’» Language: Python
    ğŸ“ Description: A sample project with dependencies
    ğŸ”— URL: https://github.com/owner/repo1
    ğŸ“… Updated: 2024-10-20T10:30:00Z
    âš ï¸  å¯èƒ½æœ‰è¿‡æ—¶ä¾èµ–:
       - å¯ç”¨äº† Dependabot è­¦æŠ¥
       - ä¾èµ–æ–‡ä»¶: requirements.txt (Python), package.json (JavaScript/Node.js)
    ğŸ” CodeQL: æ”¯æŒ (python)
...

ğŸ“„ ç»“æœå·²ä¿å­˜åˆ°: outdated_dependencies_targets.json

âœ… å®Œæˆ! å…±æ‰¾åˆ° 15 ä¸ªå¯èƒ½æœ‰è¿‡æ—¶ä¾èµ–çš„é¡¹ç›®
ğŸ” å…¶ä¸­ 12 ä¸ªé¡¹ç›®æ”¯æŒ CodeQL åˆ†æ
```

### JSONè¾“å‡ºæ–‡ä»¶

ç»“æœä¿å­˜åœ¨ `outdated_dependencies_targets.json`ï¼š

```json
{
  "generated_at": "2024-10-23T08:00:00.000000",
  "total_projects": 15,
  "min_stars": 500,
  "days_back": 60,
  "cutoff_date": "2024-08-24T08:00:00.000000",
  "projects": [
    {
      "name": "repo1",
      "full_name": "owner/repo1",
      "description": "é¡¹ç›®æè¿°",
      "url": "https://github.com/owner/repo1",
      "clone_url": "https://github.com/owner/repo1.git",
      "stars": 1234,
      "forks": 567,
      "language": "Python",
      "updated_at": "2024-10-20T10:30:00Z",
      "created_at": "2023-01-01T00:00:00Z",
      "has_issues": true,
      "open_issues": 15,
      "topics": ["security", "web"],
      "default_branch": "main",
      "dependency_check": {
        "has_outdated": true,
        "dependabot_alerts": true,
        "dependency_files": [
          "requirements.txt (Python)",
          "package.json (JavaScript/Node.js)"
        ],
        "checked_at": "2024-10-23T08:00:00.000000"
      },
      "codeql_prep": {
        "supported": true,
        "language": "python",
        "codeql_language": "python",
        "config_file": "/tmp/codeql_analysis/repo1_codeql.yml",
        "clone_url": "https://github.com/owner/repo1.git",
        "instructions": "å¯ä»¥ä½¿ç”¨ CodeQL åˆ†ææ­¤é¡¹ç›®ã€‚é…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: /tmp/codeql_analysis/repo1_codeql.yml"
      }
    }
  ]
}
```

## CodeQLé…ç½®æ–‡ä»¶

å¯¹äºæ”¯æŒCodeQLçš„é¡¹ç›®ï¼Œå·¥å…·ä¼šç”ŸæˆGitHub Actionså·¥ä½œæµé…ç½®æ–‡ä»¶ã€‚ç¤ºä¾‹ï¼š

```yaml
name: CodeQL Analysis for owner/repo1

on:
  workflow_dispatch:

jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest
    
    permissions:
      actions: read
      contents: read
      security-events: write
    
    strategy:
      fail-fast: false
      matrix:
        language: [ 'python' ]
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
      with:
        repository: owner/repo1
    
    - name: Initialize CodeQL
      uses: github/codeql-action/init@v2
      with:
        languages: ${{ matrix.language }}
    
    - name: Autobuild
      uses: github/codeql-action/autobuild@v2
    
    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v2
```

### ä½¿ç”¨CodeQLé…ç½®

1. æ‰¾åˆ°ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼ˆåœ¨ `/tmp/codeql_analysis/` ç›®å½•ä¸‹ï¼‰
2. å¤åˆ¶åˆ°ä½ çš„GitHubä»“åº“çš„ `.github/workflows/` ç›®å½•
3. æäº¤å¹¶æ¨é€
4. åœ¨GitHub Actionsä¸­æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ

## ä¸å…¶ä»–ç‰ˆæœ¬çš„å¯¹æ¯”

| ç‰¹æ€§ | target_select.py | target_select_advanced.py | target_select_outdated.py |
|------|------------------|---------------------------|---------------------------|
| ä½¿ç”¨æœç´¢API | âœ… | âœ… | âŒ |
| å…³é”®è¯æœç´¢ | âœ… | âœ… | âŒ |
| ç›´æ¥è·å–ä»“åº“ | âŒ | âŒ | âœ… |
| æ—¶é—´è¿‡æ»¤ | âŒ | âŒ | âœ… (æœ€è¿‘2ä¸ªæœˆ) |
| Dependabotæ£€æµ‹ | âŒ | âŒ | âœ… |
| ä¾èµ–æ–‡ä»¶æ£€æµ‹ | âŒ | âŒ | âœ… |
| CodeQLé…ç½®ç”Ÿæˆ | âŒ | âŒ | âœ… |
| è¯­è¨€åˆ†ç±» | âŒ | âœ… | âŒ |
| è‡ªå®šä¹‰æŸ¥è¯¢ | âŒ | âœ… | âŒ |

## APIé€Ÿç‡é™åˆ¶

### æœªè®¤è¯è¯·æ±‚
- æ¯å°æ—¶60ä¸ªè¯·æ±‚

### è®¤è¯è¯·æ±‚ï¼ˆä½¿ç”¨Tokenï¼‰
- æ¯å°æ—¶5000ä¸ªè¯·æ±‚

**å»ºè®®**ï¼šç”±äºæ­¤å·¥å…·éœ€è¦å¤§é‡APIè°ƒç”¨ï¼ˆæ¯ä¸ªä»“åº“è‡³å°‘2-3æ¬¡ï¼‰ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨GitHub Tokenã€‚

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¸ä½¿ç”¨æœç´¢APIï¼Ÿ

A: æœç´¢APIæœ‰ä»¥ä¸‹é™åˆ¶ï¼š
- æ¯åˆ†é’Ÿæœ€å¤š30æ¬¡æœç´¢è¯·æ±‚ï¼ˆå³ä½¿æœ‰Tokenï¼‰
- ç»“æœå¯èƒ½ä¸å®Œæ•´æˆ–ä¸å‡†ç¡®
- æ— æ³•ç²¾ç¡®æ§åˆ¶æ—¶é—´èŒƒå›´

ç›´æ¥è·å–æ–¹å¼è™½ç„¶éœ€è¦æ›´å¤šAPIè°ƒç”¨ï¼Œä½†ï¼š
- ç»“æœæ›´å‡†ç¡®å’Œå®Œæ•´
- å¯ä»¥ç²¾ç¡®æ§åˆ¶ç­›é€‰æ¡ä»¶
- ä¸å—æœç´¢APIçš„ç‰¹æ®Šé™åˆ¶

### Q: ä¸ºä»€ä¹ˆåªè·å–æœ€è¿‘2ä¸ªæœˆçš„é¡¹ç›®ï¼Ÿ

A: 
- æœ€è¿‘æ›´æ–°çš„é¡¹ç›®æ›´å¯èƒ½æ­£åœ¨æ´»è·ƒå¼€å‘
- å‡å°‘APIè°ƒç”¨æ¬¡æ•°
- é‡ç‚¹å…³æ³¨æ´»è·ƒä¸”æµè¡Œçš„é¡¹ç›®

ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ä»£ç è°ƒæ•´è¿™ä¸ªæ—¶é—´èŒƒå›´ï¼ˆä¿®æ”¹`days_back`å‚æ•°ï¼‰ã€‚

### Q: å¦‚ä½•åˆ¤æ–­é¡¹ç›®çœŸçš„æœ‰è¿‡æ—¶ä¾èµ–ï¼Ÿ

A: å·¥å…·ä½¿ç”¨ä¸¤ç§æ–¹æ³•ï¼š
1. **Dependabotè­¦æŠ¥**ï¼šå¦‚æœå¯ç”¨ï¼Œè¯´æ˜GitHubå·²æ£€æµ‹åˆ°å®‰å…¨é—®é¢˜
2. **ä¾èµ–æ–‡ä»¶å­˜åœ¨**ï¼šè¯´æ˜é¡¹ç›®ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼Œå¯èƒ½æœ‰ä¾èµ–

å»ºè®®æ‰‹åŠ¨éªŒè¯å¹¶ä½¿ç”¨ä¸“é—¨çš„ä¾èµ–æ£€æŸ¥å·¥å…·ï¼ˆå¦‚ `npm audit`, `pip-audit`, `snyk`ç­‰ï¼‰ã€‚

### Q: CodeQLæ”¯æŒå“ªäº›è¯­è¨€ï¼Ÿ

A: ç›®å‰æ”¯æŒï¼š
- Python
- JavaScript/TypeScript
- Java
- C/C++
- C#
- Go
- Ruby

### Q: è·å–è¿‡ç¨‹å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ

A: 
1. ç¡®ä¿è®¾ç½®äº†`GITHUB_TOKEN`
2. å‡å°‘`max_repos`å‚æ•°ï¼ˆä¿®æ”¹ä»£ç ä¸­çš„å€¼ï¼‰
3. ä¼˜åŒ–ç½‘ç»œè¿æ¥
4. ä½¿ç”¨ç¼“å­˜ï¼ˆå¯ä»¥ä¿®æ”¹ä»£ç æ·»åŠ ç¼“å­˜æœºåˆ¶ï¼‰

## æœ€ä½³å®è·µ

1. **è®¾ç½®Token**ï¼šå§‹ç»ˆä½¿ç”¨GitHub Tokenä»¥é¿å…APIé™åˆ¶
2. **åˆ†æ‰¹å¤„ç†**ï¼šä¸è¦ä¸€æ¬¡è·å–å¤ªå¤šé¡¹ç›®
3. **å®šæœŸè¿è¡Œ**ï¼šå¯ä»¥è®¾ç½®cronä½œä¸šå®šæœŸè¿è¡Œæ­¤å·¥å…·
4. **éªŒè¯ç»“æœ**ï¼šè‡ªåŠ¨æ£€æµ‹åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œéœ€è¦äººå·¥éªŒè¯
5. **è´Ÿè´£ä»»æŠ«éœ²**ï¼šå¦‚æœå‘ç°çœŸå®æ¼æ´ï¼Œè¯·è´Ÿè´£ä»»åœ°æŠ«éœ²

## è¿›é˜¶ä½¿ç”¨

### è‡ªå®šä¹‰æ—¶é—´èŒƒå›´

ä¿®æ”¹ä»£ç ä¸­çš„`days_back`å‚æ•°ï¼š

```python
checker = OutdatedDependencyChecker(
    github_token=github_token,
    min_stars=500,
    days_back=30  # æ”¹ä¸º30å¤©
)
```

### è‡ªå®šä¹‰staræ•°é˜ˆå€¼

```python
checker = OutdatedDependencyChecker(
    github_token=github_token,
    min_stars=1000,  # æ”¹ä¸º1000
    days_back=60
)
```

### å¯¼å‡ºåˆ°è‡ªå®šä¹‰æ–‡ä»¶

```python
checker.export_results(projects, "my_custom_output.json")
```

## å®‰å…¨å’Œæ³•å¾‹è¯´æ˜

âš ï¸ **é‡è¦æç¤º**ï¼š

1. æ­¤å·¥å…·**ä»…ç”¨äºå®‰å…¨ç ”ç©¶å’Œæ•™è‚²ç›®çš„**
2. ä¸è¦ç”¨äºæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•æˆ–æ”»å‡»
3. éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’ŒGitHubæœåŠ¡æ¡æ¬¾
4. å°Šé‡é¡¹ç›®ç»´æŠ¤è€…çš„åŠ³åŠ¨æˆæœ
5. å¦‚å‘ç°æ¼æ´ï¼Œè¯·è´Ÿè´£ä»»åœ°æŠ«éœ²

## è®¸å¯è¯

MIT License
